{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/wellmaintained/skills/schemas/marketplace.schema.json",
  "title": "Claude Code Marketplace Schema",
  "description": "Schema for Claude Code plugin marketplace.json files",
  "type": "object",
  "required": ["name", "owner", "plugins"],
  "additionalProperties": false,
  "properties": {
    "name": {
      "type": "string",
      "description": "Marketplace identifier (kebab-case, no spaces)",
      "pattern": "^[a-z0-9]+(-[a-z0-9]+)*$",
      "minLength": 1
    },
    "owner": {
      "type": "object",
      "description": "Marketplace maintainer information",
      "required": ["name"],
      "additionalProperties": false,
      "properties": {
        "name": {
          "type": "string",
          "description": "Owner name",
          "minLength": 1
        },
        "email": {
          "type": "string",
          "description": "Owner email address",
          "format": "email"
        },
        "url": {
          "type": "string",
          "description": "Owner website or profile URL",
          "format": "uri"
        }
      }
    },
    "plugins": {
      "type": "array",
      "description": "List of available plugins",
      "items": {
        "$ref": "#/$defs/pluginEntry"
      }
    },
    "metadata": {
      "type": "object",
      "description": "Optional marketplace metadata",
      "additionalProperties": false,
      "properties": {
        "description": {
          "type": "string",
          "description": "Brief marketplace description"
        },
        "version": {
          "type": "string",
          "description": "Marketplace version (semver)",
          "pattern": "^\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9.-]+)?(\\+[a-zA-Z0-9.-]+)?$"
        },
        "pluginRoot": {
          "type": "string",
          "description": "Base path for relative plugin sources",
          "pattern": "^\\."
        },
        "homepage": {
          "type": "string",
          "description": "Marketplace homepage URL",
          "format": "uri"
        },
        "lastUpdated": {
          "type": "string",
          "description": "ISO 8601 timestamp of last update",
          "format": "date-time"
        },
        "pluginCount": {
          "type": "integer",
          "description": "Number of plugins in marketplace",
          "minimum": 0
        }
      }
    }
  },
  "$defs": {
    "pluginEntry": {
      "type": "object",
      "required": ["name", "source"],
      "additionalProperties": false,
      "properties": {
        "name": {
          "type": "string",
          "description": "Plugin identifier (kebab-case, no spaces)",
          "pattern": "^[a-z0-9]+(-[a-z0-9]+)*$",
          "minLength": 1
        },
        "source": {
          "description": "Where to fetch the plugin from",
          "oneOf": [
            {
              "type": "string",
              "description": "Relative path to plugin",
              "pattern": "^\\."
            },
            {
              "type": "object",
              "required": ["source"],
              "additionalProperties": false,
              "properties": {
                "source": {
                  "type": "string",
                  "enum": ["github", "url", "git"],
                  "description": "Source type"
                },
                "repo": {
                  "type": "string",
                  "description": "GitHub repository (owner/repo)",
                  "pattern": "^[a-zA-Z0-9_.-]+/[a-zA-Z0-9_.-]+$"
                },
                "url": {
                  "type": "string",
                  "description": "Git repository URL",
                  "format": "uri"
                },
                "path": {
                  "type": "string",
                  "description": "Path within repository to plugin"
                },
                "branch": {
                  "type": "string",
                  "description": "Git branch to use"
                },
                "tag": {
                  "type": "string",
                  "description": "Git tag to use"
                },
                "commit": {
                  "type": "string",
                  "description": "Git commit hash to use"
                }
              },
              "allOf": [
                {
                  "if": {
                    "properties": { "source": { "const": "github" } }
                  },
                  "then": {
                    "required": ["repo"]
                  }
                },
                {
                  "if": {
                    "properties": { "source": { "enum": ["url", "git"] } }
                  },
                  "then": {
                    "required": ["url"]
                  }
                }
              ]
            }
          ]
        },
        "description": {
          "type": "string",
          "description": "Brief plugin description",
          "minLength": 1
        },
        "version": {
          "type": "string",
          "description": "Plugin version (semver)",
          "pattern": "^\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9.-]+)?(\\+[a-zA-Z0-9.-]+)?$"
        },
        "author": {
          "oneOf": [
            {
              "type": "string",
              "description": "Author name or name with email"
            },
            {
              "type": "object",
              "required": ["name"],
              "additionalProperties": false,
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Author name",
                  "minLength": 1
                },
                "email": {
                  "type": "string",
                  "description": "Author email address",
                  "format": "email"
                },
                "url": {
                  "type": "string",
                  "description": "Author website or profile URL",
                  "format": "uri"
                }
              }
            }
          ]
        },
        "homepage": {
          "type": "string",
          "description": "Plugin homepage or documentation URL",
          "format": "uri"
        },
        "repository": {
          "oneOf": [
            {
              "type": "string",
              "description": "Source code repository URL",
              "format": "uri"
            },
            {
              "type": "object",
              "required": ["url"],
              "additionalProperties": false,
              "properties": {
                "type": {
                  "type": "string",
                  "description": "Repository type",
                  "enum": ["git", "svn", "hg"]
                },
                "url": {
                  "type": "string",
                  "description": "Repository URL",
                  "format": "uri"
                },
                "directory": {
                  "type": "string",
                  "description": "Directory within repository"
                }
              }
            }
          ]
        },
        "license": {
          "type": "string",
          "description": "SPDX license identifier (e.g., MIT, Apache-2.0)",
          "minLength": 1
        },
        "keywords": {
          "type": "array",
          "description": "Tags for plugin discovery and categorization",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "category": {
          "type": "string",
          "description": "Plugin category for organization",
          "minLength": 1
        },
        "tags": {
          "type": "array",
          "description": "Tags for searchability",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "strict": {
          "type": "boolean",
          "description": "Require plugin.json in plugin folder (default: true)",
          "default": true
        },
        "commands": {
          "oneOf": [
            {
              "type": "string",
              "description": "Custom path to command files or directories",
              "pattern": "^\\."
            },
            {
              "type": "array",
              "description": "Custom paths to command files or directories",
              "items": {
                "type": "string",
                "pattern": "^\\."
              }
            }
          ]
        },
        "agents": {
          "oneOf": [
            {
              "type": "string",
              "description": "Custom path to agent files",
              "pattern": "^\\."
            },
            {
              "type": "array",
              "description": "Custom paths to agent files",
              "items": {
                "type": "string",
                "pattern": "^\\."
              }
            }
          ]
        },
        "skills": {
          "oneOf": [
            {
              "type": "string",
              "description": "Custom path to skills directory",
              "pattern": "^\\."
            },
            {
              "type": "array",
              "description": "Custom paths to skills directories",
              "items": {
                "type": "string",
                "pattern": "^\\."
              }
            }
          ]
        },
        "hooks": {
          "oneOf": [
            {
              "type": "string",
              "description": "Custom path to hooks file",
              "pattern": "^\\."
            },
            {
              "type": "object",
              "description": "Inline hooks configuration",
              "additionalProperties": true
            }
          ]
        },
        "mcpServers": {
          "oneOf": [
            {
              "type": "string",
              "description": "Custom path to MCP config file",
              "pattern": "^\\."
            },
            {
              "type": "object",
              "description": "Inline MCP server configurations",
              "additionalProperties": true
            }
          ]
        },
        "requirements": {
          "type": "object",
          "description": "Plugin requirements",
          "additionalProperties": {
            "type": "string"
          }
        },
        "installation": {
          "type": "object",
          "description": "Installation configuration",
          "additionalProperties": true
        }
      }
    }
  }
}
